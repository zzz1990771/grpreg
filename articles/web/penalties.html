<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Penalties • grpreg</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><link href="../../extra.css" rel="stylesheet">
<script src="../../extra.js"></script><meta property="og:title" content="Penalties">
<meta property="og:description" content="grpreg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">grpreg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../articles/getting-started.html">Getting started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Learn more
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/web/models.html">Models</a>
    </li>
    <li>
      <a href="../../articles/web/penalties.html">Penalties</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../reference/index.html">Functions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/pbreheny/grpreg">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="penalties_files/header-attrs-2.1/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Penalties</h1>
                        <h4 class="author">Patrick Breheny</h4>
            
      
      <small class="dont-index">Source: <a href="http://github.com/pbreheny/grpreg/blob/master/vignettes/web/penalties.rmd"><code>vignettes/web/penalties.rmd</code></a></small>
      <div class="hidden name"><code>penalties.rmd</code></div>

    </div>

    
    
<p><code>grpreg</code> fits models that fall into the penalized likelihood framework, in which we estimate <span class="math inline">\(\bb\)</span> by minimizing the objective function</p>
<p><span class="math display">\[
Q(\bb|\X, \y) = L(\bb|\X,\y) + P_\lam(\bb),
\]</span></p>
<p>where <span class="math inline">\(L(\bb|\X,\y)\)</span> is the loss (deviance) and <span class="math inline">\(P_\lam(\bb)\)</span> is the penalty. This article describes the different penalties available in <code>grpreg</code>; see <a href="models.html">models</a> for more information on the different loss functions available.</p>
<p>The following notation is used throughout (recall that the design matrix <span class="math inline">\(\X\)</span> is decomposed into groups <span class="math inline">\(\X_1, \X_2, \ldots\)</span>:</p>
<ul>
<li>
<span class="math inline">\(\bb\)</span> denotes the entire vector of regression coefficients</li>
<li>
<span class="math inline">\(\bb_j\)</span> denotes the vector of regression coefficients corresponding to the <span class="math inline">\(j\)</span>th group</li>
<li>
<span class="math inline">\(\beta_{jk}\)</span> denotes <span class="math inline">\(k\)</span>th regression coefficient in the <span class="math inline">\(j\)</span>th group</li>
<li>
<span class="math inline">\(\norm{\bb_j}\)</span> denotes the Euclidean (<span class="math inline">\(L_2\)</span>) norm of <span class="math inline">\(\bb_j\)</span>
</li>
<li>
<span class="math inline">\(\norm{\bb_j}_1\)</span> denotes the <span class="math inline">\(L_1\)</span> norm of <span class="math inline">\(\beta_j\)</span> (Manhattan distance)</li>
</ul>
<div id="group-selection" class="section level2">
<h2 class="hasAnchor">
<a href="#group-selection" class="anchor"></a>Group selection</h2>
<p>These penalties are sparse at the group level – the coefficients within a group will either all equal zero or none will equal zero.</p>
<p>If you use any of these penalties, please cite</p>
<ul>
<li>Breheny P and Huang J (2015). Group descent algorithms for nonconvex penalized linear and logistic regression models with grouped predictors. <em>Statistics and Computing</em>, <strong>25</strong>: 173-187. [<a href="http://myweb.uiowa.edu/pbreheny/pdf/group-computing.pdf">pdf</a>].</li>
</ul>
<p>The article goes into more mathematical details, discusses issues of standardization in the group sense, and provides references.</p>
<p>The group lasso was originally proposed in</p>
<ul>
<li>Yuan M. and Lin Y. (2006) Model selection and estimation in regression with grouped variables. <em>Journal of the Royal Statistical Society Series B</em>, <strong>68</strong>: 49-67.</li>
</ul>
<div id="group-lasso" class="section level3">
<h3 class="hasAnchor">
<a href="#group-lasso" class="anchor"></a>Group lasso</h3>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="../../reference/grpreg.html">grpreg</a></span>(<span class="no">X</span>, <span class="no">y</span>, <span class="no">group</span>, <span class="kw">penalty</span><span class="kw">=</span><span class="st">"grLasso"</span>)</pre></body></html></div>
<p><span class="math display">\[
P(\beta) = \lam \sum_j \norm{\bb_j}
\]</span></p>
</div>
<div id="group-mcp" class="section level3">
<h3 class="hasAnchor">
<a href="#group-mcp" class="anchor"></a>Group MCP</h3>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="../../reference/grpreg.html">grpreg</a></span>(<span class="no">X</span>, <span class="no">y</span>, <span class="no">group</span>, <span class="kw">penalty</span><span class="kw">=</span><span class="st">"grMCP"</span>)</pre></body></html></div>
<p><span class="math display">\[
P(\bb) = \sum_j \textrm{MCP}_{\lam, \gamma}(\norm{\bb_j})
\]</span></p>
<p>where <span class="math inline">\(\textrm{MCP}_{\lam, \gamma}(\cdot)\)</span> denotes the MCP penalty with regularization parameter <span class="math inline">\(\lam\)</span> and tuning parameter <span class="math inline">\(\gamma\)</span>.</p>
</div>
<div id="group-scad" class="section level3">
<h3 class="hasAnchor">
<a href="#group-scad" class="anchor"></a>Group SCAD</h3>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="../../reference/grpreg.html">grpreg</a></span>(<span class="no">X</span>, <span class="no">y</span>, <span class="no">group</span>, <span class="kw">penalty</span><span class="kw">=</span><span class="st">"grSCAD"</span>)</pre></body></html></div>
<p><span class="math display">\[
P(\bb) = \sum_j \textrm{SCAD}_{\lam, \gamma}(\norm{\bb_j})
\]</span></p>
<p>where <span class="math inline">\(\textrm{SCAD}_{\lam, \gamma}(\cdot)\)</span> denotes the SCAD penalty with regularization parameter <span class="math inline">\(\lam\)</span> and tuning parameter <span class="math inline">\(\gamma\)</span>.</p>
</div>
</div>
<div id="bi-level-selection" class="section level2">
<h2 class="hasAnchor">
<a href="#bi-level-selection" class="anchor"></a>Bi-level selection</h2>
<p>These penalties are sparse at both the group and individual levels. In some groups, all coefficients will equal zero. However, even if a group is selected, some of the coefficients within that group may still be zero.</p>
<div id="group-exponential-lasso-gel" class="section level3">
<h3 class="hasAnchor">
<a href="#group-exponential-lasso-gel" class="anchor"></a>Group exponential lasso (GEL)</h3>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="../../reference/grpreg.html">grpreg</a></span>(<span class="no">X</span>, <span class="no">y</span>, <span class="no">group</span>, <span class="kw">penalty</span><span class="kw">=</span><span class="st">"gel"</span>)</pre></body></html></div>
<p><span class="math display">\[
P(\beta) = \sum_j f_{\lam, \tau}(\norm{\bb_j})
\]</span></p>
<p>where <span class="math inline">\(f(\cdot)\)</span> denotes the exponential penalty with regularization parameter <span class="math inline">\(\lam\)</span> and tuning parameter <span class="math inline">\(\tau\)</span>:</p>
<p><span class="math display">\[
f_{\lam, \tau}(\theta) = \frac{\lam^2}{\tau}\left\{1-\exp\left(-\frac{\tau\theta}{\lam}\right)\right\}
\]</span></p>
<p>If you use the GEL penalty, please cite</p>
<ul>
<li>Breheny P (2015). The group exponential lasso for bi-level variable selection. <em>Biometrics</em>, <strong>71</strong>: 731-740. [<a href="http://onlinelibrary.wiley.com/doi/10.1111/biom.12300/pdf">pdf</a>].</li>
</ul>
</div>
<div id="composite-mcp" class="section level3">
<h3 class="hasAnchor">
<a href="#composite-mcp" class="anchor"></a>Composite MCP</h3>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="../../reference/grpreg.html">grpreg</a></span>(<span class="no">X</span>, <span class="no">y</span>, <span class="no">group</span>, <span class="kw">penalty</span><span class="kw">=</span><span class="st">"cMCP"</span>)</pre></body></html></div>
<p><span class="math display">\[
P(\bb) = \sum_j \textrm{MCP}_{\lam, \gam_1} \left( \sum_k \textrm{MCP}_{\lam, \gam_2} (\abs{\beta_{jk}}) \right)
\]</span></p>
<p>where <span class="math inline">\(\textrm{MCP}_{\lam, \gamma}(\cdot)\)</span> denotes the MCP penalty with regularization parameter <span class="math inline">\(\lam\)</span> and tuning parameter <span class="math inline">\(\gamma\)</span>.</p>
<p>If you use the composite MCP penalty, please cite either of the following papers:</p>
<ul>
<li>Breheny P and Huang J (2009). Penalized methods for bi-level variable selection. <em>Statistics and Its Interface</em>, <strong>2</strong>: 369-380. [<a href="http://myweb.uiowa.edu/pbreheny/pdf/Breheny2009.pdf">pdf</a>]</li>
<li>Huang J, Breheny P and Ma S (2012). A selective review of group selection in high-dimensional models. <em>Statistical Science</em>, <strong>27</strong>: 481-499. [<a href="http://myweb.uiowa.edu/pbreheny/pdf/Huang2012.pdf">pdf</a>]</li>
</ul>
<p>Please note that there is some confusion around the name “group MCP”. In the first paper above (2009), the composite MCP penalty was referred to as the “group MCP” penalty; the second paper (2012), in reviewing the various kinds of group penalties that had been proposed, recommended changing the name to “composite MCP” to avoid confusion with the “group MCP” <a href="#group-mcp">defined above</a>.</p>
</div>
<div id="group-bridge" class="section level3">
<h3 class="hasAnchor">
<a href="#group-bridge" class="anchor"></a>Group bridge</h3>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="../../reference/gBridge.html">gBridge</a></span>(<span class="no">X</span>, <span class="no">y</span>, <span class="no">group</span>)</pre></body></html></div>
<p><span class="math display">\[
P(\bb) = \lambda \sum_j K_j^\gamma \norm{\bb_j}_1^\gamma
\]</span></p>
<p>where <span class="math inline">\(K_j\)</span> denotes the number of elements in group <span class="math inline">\(j\)</span>.</p>
<p>Please note that the group bridge penalty uses a very different algorithm from the other penalties. Due to the nature of the penalty, model fitting is slower and less stable for group bridge models. This is, in fact, the main motivation of the GEL penalty of Section~: to offer a more tractable alternative to group bridge that has similar estimation properties but is much better behaved from a numerical optimization perspective.</p>
<p>If you use the group bridge penalty, please cite either of the following papers:</p>
<ul>
<li>Huang J, Ma S, Xie H and Zhang C (2009). A group bridge approach for variable selection. <em>Biometrika</em>, <strong>96</strong>: 339-355.</li>
<li>Breheny P and Huang J (2009). Penalized methods for bi-level variable selection. <em>Statistics and Its Interface</em>, <strong>2</strong>: 369-380. [<a href="%5Chref%7Bhttp://myweb.uiowa.edu/pbreheny/publications/Breheny2009.pdf">pdf</a>]</li>
</ul>
<p>The first paper proposed the method; the second paper proposed the algorithm that is used in the <code>grpreg</code> package.</p>
</div>
</div>
<div id="specifying-an-additional-ridge-component" class="section level2">
<h2 class="hasAnchor">
<a href="#specifying-an-additional-ridge-component" class="anchor"></a>Specifying an additional ridge component</h2>
<p>For all of the penalties in the previous section, <code>grpreg</code> allows the specification of an additional ridge (<span class="math inline">\(L_2\)</span>) component to the penalty. This will set <span class="math inline">\(\lam_1 = \alpha\lam\)</span> and <span class="math inline">\(\lam_2=(1-\alpha)\lam\)</span>, with the penalty given by</p>
<p><span class="math display">\[
P(\bb) = P_1(\bb|\lam_1) + \frac{\lam_2}{2}\norm{\bb}^2,
\]</span></p>
<p>where <span class="math inline">\(P_1\)</span> is any of the penalties from the earlier sections. So, for example</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="fu"><a href="../../reference/grpreg.html">grpreg</a></span>(<span class="no">X</span>, <span class="no">y</span>, <span class="no">group</span>, <span class="kw">penalty</span><span class="kw">=</span><span class="st">"grLasso"</span>, <span class="kw">alpha</span><span class="kw">=</span><span class="fl">0.75</span>)</pre></body></html></div>
<p>will fit a model with penalty</p>
<p><span class="math display">\[
P(\beta) = 0.75\lam \sum_j \norm{\bb_j} + \frac{0.25\lam}{2}\norm{\bb}^2.
\]</span></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Patrick Breheny.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
