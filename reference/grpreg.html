<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fit a group penalized regression path — grpreg • grpreg</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  <script src="../extra.js"></script>

<meta property="og:title" content="Fit a group penalized regression path — grpreg" />
<meta property="og:description" content="Fit regularization paths for models with grouped penalties
  over a grid of values for the regularization parameter lambda. Fits
  linear and logistic regression models." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">grpreg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/getting-started.html">Getting started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Learn more
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/web/models.html">Models</a>
    </li>
    <li>
      <a href="../articles/web/penalties.html">Penalties</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/pbreheny/grpreg">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit a group penalized regression path</h1>
    
    <div class="hidden name"><code>grpreg.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fit regularization paths for models with grouped penalties
  over a grid of values for the regularization parameter lambda. Fits
  linear and logistic regression models.</p>
    </div>

    <pre class="usage"><span class='fu'>grpreg</span>(<span class='no'>X</span>, <span class='no'>y</span>, <span class='kw'>group</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span>(<span class='no'>X</span>), <span class='kw'>penalty</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"grLasso"</span>, <span class='st'>"grMCP"</span>, <span class='st'>"grSCAD"</span>,
<span class='st'>"gel"</span>, <span class='st'>"cMCP"</span>), <span class='kw'>family</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"gaussian"</span>, <span class='st'>"binomial"</span>, <span class='st'>"poisson"</span>),
<span class='kw'>nlambda</span><span class='kw'>=</span><span class='fl'>100</span>, <span class='no'>lambda</span>, <span class='kw'>lambda.min</span><span class='kw'>=</span>{<span class='kw'>if</span> (<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>X</span>) <span class='kw'>&gt;</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span>(<span class='no'>X</span>)) <span class='fl'>1e-4</span> <span class='kw'>else</span> <span class='fl'>.05</span>},
<span class='kw'>log.lambda</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>alpha</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>eps</span><span class='kw'>=</span><span class='fl'>1e-4</span>, <span class='kw'>max.iter</span><span class='kw'>=</span><span class='fl'>10000</span>, <span class='kw'>dfmax</span><span class='kw'>=</span><span class='no'>p</span>,
<span class='kw'>gmax</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span>(<span class='no'>group</span>)), <span class='kw'>gamma</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span>(<span class='no'>penalty</span> <span class='kw'>==</span> <span class='st'>"grSCAD"</span>, <span class='fl'>4</span>, <span class='fl'>3</span>),
<span class='kw'>tau</span> <span class='kw'>=</span> <span class='fl'>1</span>/<span class='fl'>3</span>, <span class='no'>group.multiplier</span>, <span class='kw'>warn</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>returnX</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>X</th>
      <td><p>The design matrix, without an intercept.  <code>grpreg</code>
    standardizes the data and includes an intercept by default.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>The response vector, or a matrix in the case of multitask
    learning (see details).</p></td>
    </tr>
    <tr>
      <th>group</th>
      <td><p>A vector describing the grouping of the coefficients.
    For greatest efficiency and least ambiguity (see details), it is
    best if <code>group</code> is a factor or vector of consecutive integers,
    although unordered groups and character vectors are also allowed.
    If there are coefficients to be included in the model without being
    penalized, assign them to group 0 (or <code>"0"</code>).</p></td>
    </tr>
    <tr>
      <th>penalty</th>
      <td><p>The penalty to be applied to the model.  For group
    selection, one of <code>grLasso</code>, <code>grMCP</code>, or <code>grSCAD</code>.
    For bi-level selection, one of <code>gel</code> or <code>cMCP</code>.  See
    below for details.</p></td>
    </tr>
    <tr>
      <th>family</th>
      <td><p>Either "gaussian" or "binomial", depending on the
    response.</p></td>
    </tr>
    <tr>
      <th>nlambda</th>
      <td><p>The number of <code>lambda</code> values.  Default is 100.</p></td>
    </tr>
    <tr>
      <th>lambda</th>
      <td><p>A user supplied sequence of <code>lambda</code> values.
    Typically, this is left unspecified, and the function automatically
    computes a grid of lambda values that ranges uniformly on the log
    scale over the relevant range of lambda values.</p></td>
    </tr>
    <tr>
      <th>lambda.min</th>
      <td><p>The smallest value for <code>lambda</code>, as a fraction
    of <code>lambda.max</code>.  Default is .0001 if the number of
    observations is larger than the number of covariates and .05
    otherwise.</p></td>
    </tr>
    <tr>
      <th>log.lambda</th>
      <td><p>Whether compute the grid values of lambda on log
    scale (default) or linear scale.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p><code>grpreg</code> allows for both a group penalty and an L2
    (ridge) penalty; <code>alpha</code> controls the proportional weight of
    the regularization parameters of these two penalties.  The group
    penalties' regularization parameter is <code>lambda*alpha</code>, while
    the regularization parameter of the ridge penalty is
    <code>lambda*(1-alpha)</code>.  Default is 1: no ridge penalty.</p></td>
    </tr>
    <tr>
      <th>eps</th>
      <td><p>Convergence threshhold.  The algorithm iterates until the
    RMSD for the change in linear predictors for each coefficient is
    less than <code>eps</code>.  Default is <code>1e-4</code>.  See details.</p></td>
    </tr>
    <tr>
      <th>max.iter</th>
      <td><p>Maximum number of iterations (total across entire
    path). Default is 10000.  See details.</p></td>
    </tr>
    <tr>
      <th>dfmax</th>
      <td><p>Limit on the number of parameters allowed to be nonzero.
    If this limit is exceeded, the algorithm will exit early from the
    regularization path.</p></td>
    </tr>
    <tr>
      <th>gmax</th>
      <td><p>Limit on the number of groups allowed to have nonzero
    elements.  If this limit is exceeded, the algorithm will exit early
    from the regularization path.</p></td>
    </tr>
    <tr>
      <th>gamma</th>
      <td><p>Tuning parameter of the group or composite MCP/SCAD
    penalty (see details).  Default is 3 for MCP and 4 for SCAD.</p></td>
    </tr>
    <tr>
      <th>tau</th>
      <td><p>Tuning parameter for the group exponential lasso; defaults
    to 1/3.</p></td>
    </tr>
    <tr>
      <th>group.multiplier</th>
      <td><p>A vector of values representing multiplicative
    factors by which each group's penalty is to be multiplied.
    Often, this is a function (such as the square root) of the number of
    predictors in each group.  The default is to use the square root of
    group size for the group selection methods, and a vector of 1's
    (i.e., no adjustment for group size) for bi-level selection.</p></td>
    </tr>
    <tr>
      <th>warn</th>
      <td><p>Should the function give a warning if it fails to
    converge?  Default is TRUE.  See details.</p></td>
    </tr>
    <tr>
      <th>returnX</th>
      <td><p>Return the standardized design matrix (and associated
    group structure information)?  Default is FALSE.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Arguments passed to other functions (such as gBridge).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>There are two general classes of methods involving grouped penalties:
  those that carry out bi-level selection and those that carry out group
  selection.  Bi-level means carrying out variable selection at the
  group level as well as the level of individual covariates (i.e.,
  selecting important groups as well as important members of those
  groups).  Group selection selects important groups, and not members
  within the group -- i.e., within a group, coefficients will either all
  be zero or all nonzero.  The <code>grLasso</code>, <code>grMCP</code>, and
  <code>grSCAD</code> penalties carry out group selection, while the
  <code>gel</code> and <code>cMCP</code> penalties carry out bi-level selection.
  For bi-level selection, see also the <code><a href='gBridge.html'>gBridge</a></code> function.
  For historical reasons and backwards compatibility, some of these
  penalties have aliases; e.g., <code>gLasso</code> will do the same thing as
  <code>grLasso</code>, but users are encouraged to use <code>grLasso</code>.</p>
<p>Please note the distinction between <code>grMCP</code> and <code>cMCP</code>.  The
  former involves an MCP penalty being applied to an L2-norm of each
  group.  The latter involves a hierarchical penalty which places an
  outer MCP penalty on a sum of inner MCP penalties for each group, as
  proposed in Breheny &amp; Huang, 2009.  Either penalty may be referred to
  as the "group MCP", depending on the publication.  To resolve this
  confusion, Huang et al. (2012) proposed the name "composite MCP" for
  the <code>cMCP</code> penalty.</p>
<p>For more information about the penalties and their properties, please
  consult the references below, many of which contain discussion, case
  studies, and simulation studies comparing the methods.  If you use
  <code>grpreg</code> for an analysis, please cite the appropriate reference.</p>
<p>In keeping with the notation from the original MCP paper, the tuning
  parameter of the MCP penalty is denoted 'gamma'.  Note, however, that
  in Breheny and Huang (2009), <code>gamma</code> is denoted 'a'.</p>
<p>The objective function for <code>grpreg</code> optimization is defined to be
  $$Q(\beta|X, y) = \frac{1}{n} L(\beta|X, y) +
    P_\lambda(\beta)$$
  where the loss function L is the deviance (-2 times the log
  likelihood) for the specified outcome distribution
  (gaussian/binomial/poisson).
  <a href='http://pbreheny.github.io/ncvreg/articles/web/models.html'>See
    here for more details</a>.</p>
<p>For the bi-level selection methods, a locally approximated coordinate
  descent algorithm is employed.  For the group selection methods, group
  descent algorithms are employed.</p>
<p>The algorithms employed by <code>grpreg</code> are stable and generally
  converge quite rapidly to values close to the solution.  However,
  especially when p is large compared with n, <code>grpreg</code> may fail to
  converge at low values of <code>lambda</code>, where models are
  nonidentifiable or nearly singular.  Often, this is not the region of
  the coefficient path that is most interesting.  The default behavior
  warning the user when convergence criteria are not met may be
  distracting in these cases, and can be modified with <code>warn</code>
  (convergence can always be checked later by inspecting the value of
  <code>iter</code>).</p>
<p>If models are not converging, increasing <code>max.iter</code> may not be
  the most efficient way to correct this problem.  Consider increasing
  <code>n.lambda</code> or <code>lambda.min</code> in addition to increasing
  <code>max.iter</code>.</p>
<p>Although <code>grpreg</code> allows groups to be unordered and given
  arbitary names, it is recommended that you specify groups as
  consecutive integers.  The first reason is efficiency: if groups are
  out of order, <code>X</code> must be reordered prior to fitting, then this
  process reversed to return coefficients according to the original
  order of <code>X</code>.  This is inefficient if <code>X</code> is very large.
  The second reason is ambiguity with respect to other arguments such as
  <code>group.multiplier</code>.  With consecutive integers, <code>group=3</code>
  unambiguously denotes the third element of <code>group.multiplier</code>.</p>
<p>Seemingly unrelated regressions/multitask learning can be carried out
  using <code>grpreg</code> by passing a matrix to <code>y</code>.  In this case,
  <code>X</code> will be used in separate regressions for each column of
  <code>y</code>, with the coefficients grouped across the responses.  In
  other words, each column of <code>X</code> will form a group with m
  members, where m is the number of columns of <code>y</code>.  For multiple
  Gaussian responses, it is recommended to standardize the columns of
  <code>y</code> prior to fitting, in order to apply the penalization equally
  across columns.</p>
<p><code>grpreg</code> requires groups to be non-overlapping.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object with S3 class <code>"grpreg"</code> containing:</p><dl'>
    <dt>beta</dt><dd><p>The fitted matrix of coefficients.  The number of rows
      is equal to the number of coefficients, and the number of columns
      is equal to <code>nlambda</code>.</p></dd>
    <dt>family</dt><dd><p>Same as above.</p></dd>
    <dt>group</dt><dd><p>Same as above.</p></dd>
    <dt>lambda</dt><dd><p>The sequence of <code>lambda</code> values in the path.</p></dd>
    <dt>alpha</dt><dd><p>Same as above.</p></dd>
    <dt>loss</dt><dd><p>A vector containing either the residual sum of squares
      (<code>"gaussian"</code>) or negative log-likelihood (<code>"binomial"</code>)
      of the fitted model at each value of <code>lambda</code>.</p></dd>
    <dt>n</dt><dd><p>Number of observations.</p></dd>
    <dt>penalty</dt><dd><p>Same as above.</p></dd>
    <dt>df</dt><dd><p>A vector of length <code>nlambda</code> containing estimates of
      effective number of model parameters all the points along the
      regularization path.  For details on how this is calculated, see
      Breheny and Huang (2009).</p></dd>
    <dt>iter</dt><dd><p>A vector of length <code>nlambda</code> containing the number
      of iterations until convergence at each value of <code>lambda</code>.</p></dd>
    <dt>group.multiplier</dt><dd><p>A named vector containing the multiplicative
      constant applied to each group's penalty.</p></dd>
  
</dl>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p></p><ul>
<li><p>Breheny, P. and Huang, J. (2009) Penalized methods for
    bi-level variable selection.  <em>Statistics and its interface</em>,
    <strong>2</strong>: 369-380.
    <a href='http://myweb.uiowa.edu/pbreheny/pdf/Breheny2009.pdf'>http://myweb.uiowa.edu/pbreheny/pdf/Breheny2009.pdf</a></p></li>
<li><p>Huang J., Breheny, P. and Ma, S. (2012). A selective
    review of group selection in high dimensional
    models. <em>Statistical Science</em>, <strong>27</strong>: 481-499.
    <a href='http://myweb.uiowa.edu/pbreheny/pdf/Huang2012.pdf'>http://myweb.uiowa.edu/pbreheny/pdf/Huang2012.pdf</a></p></li>
<li><p>Breheny, P. and Huang, J. (2015) Group descent algorithms for
    nonconvex penalized linear and logistic regression models with grouped
    predictors.  <em>Statistics and Computing</em>, <strong>25</strong>: 173-187.
    <a href='http://dx.doi.org/10.1007/s11222-013-9424-2'>http://dx.doi.org/10.1007/s11222-013-9424-2</a></p></li>
<li><p>Breheny, P. (2015) The group exponential lasso for bi-level
    variable selection. <em>Biometrics</em>, <strong>71</strong>: 731-740.
    <a href='http://dx.doi.org/10.1111/biom.12300'>http://dx.doi.org/10.1111/biom.12300</a></p></li>
</ul>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='cv-grpreg.html'>cv.grpreg</a></code>, as well as
  <code><a href='plot-grpreg.html'>plot</a></code> and
  <code><a href='select-grpreg.html'>select</a></code> methods.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Birthweight data</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>Birthwt</span>)
<span class='no'>X</span> <span class='kw'>&lt;-</span> <span class='no'>Birthwt</span>$<span class='no'>X</span>
<span class='no'>group</span> <span class='kw'>&lt;-</span> <span class='no'>Birthwt</span>$<span class='no'>group</span>

<span class='co'># Linear regression</span>
<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='no'>Birthwt</span>$<span class='no'>bwt</span>
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'>grpreg</span>(<span class='no'>X</span>, <span class='no'>y</span>, <span class='no'>group</span>, <span class='kw'>penalty</span><span class='kw'>=</span><span class='st'>"grLasso"</span>)
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>fit</span>)</div><div class='img'><img src='grpreg-1.png' alt='' width='480' height='480' /></div><div class='input'><span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'>grpreg</span>(<span class='no'>X</span>, <span class='no'>y</span>, <span class='no'>group</span>, <span class='kw'>penalty</span><span class='kw'>=</span><span class='st'>"grMCP"</span>)
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>fit</span>)</div><div class='img'><img src='grpreg-2.png' alt='' width='480' height='480' /></div><div class='input'><span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'>grpreg</span>(<span class='no'>X</span>, <span class='no'>y</span>, <span class='no'>group</span>, <span class='kw'>penalty</span><span class='kw'>=</span><span class='st'>"grSCAD"</span>)
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>fit</span>)</div><div class='img'><img src='grpreg-3.png' alt='' width='480' height='480' /></div><div class='input'><span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'>grpreg</span>(<span class='no'>X</span>, <span class='no'>y</span>, <span class='no'>group</span>, <span class='kw'>penalty</span><span class='kw'>=</span><span class='st'>"gel"</span>)
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>fit</span>)</div><div class='img'><img src='grpreg-4.png' alt='' width='480' height='480' /></div><div class='input'><span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'>grpreg</span>(<span class='no'>X</span>, <span class='no'>y</span>, <span class='no'>group</span>, <span class='kw'>penalty</span><span class='kw'>=</span><span class='st'>"cMCP"</span>)
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>fit</span>)</div><div class='img'><img src='grpreg-5.png' alt='' width='480' height='480' /></div><div class='input'><span class='fu'><a href='select-grpreg.html'>select</a></span>(<span class='no'>fit</span>, <span class='st'>"AIC"</span>)</div><div class='output co'>#&gt; $beta
#&gt; (Intercept)        age1        age2        age3        lwt1        lwt2 
#&gt;  3.03000773  0.00000000  1.14484129  0.57059454  1.30067773  0.00000000 
#&gt;        lwt3       white       black       smoke        ptl1       ptl2m 
#&gt;  0.90025980  0.29687103 -0.05940071 -0.26940924 -0.23983487  0.01075293 
#&gt;          ht          ui        ftv1        ftv2       ftv3m 
#&gt; -0.45620940 -0.44477459  0.01632410  0.00000000 -0.02590741 
#&gt; 
#&gt; $lambda
#&gt; [1] 0.03869348
#&gt; 
#&gt; $df
#&gt; [1] 9.805114
#&gt; 
#&gt; $IC
#&gt;   [1] 419.9884 415.9171 413.0551 410.1149 405.8256 401.0234 395.6942 390.8250
#&gt;   [9] 385.9994 381.6926 378.2296 375.6049 373.2817 371.5483 370.2815 369.4147
#&gt;  [17] 368.8327 368.4968 368.3677 368.4282 368.5912 368.8236 369.1017 369.4053
#&gt;  [25] 369.7208 370.0378 370.3488 370.6482 370.9327 371.1999 371.4486 371.6783
#&gt;  [33] 371.8892 372.0816 372.2563 372.4144 372.7731 373.3927 374.3380 375.1275
#&gt;  [41] 375.7750 376.3135 376.7658 377.1486 377.4743 377.7527 377.9913 378.1963
#&gt;  [49] 378.3725 378.5237 378.6542 378.7677 378.8665 378.9522 379.0265 379.0914
#&gt;  [57] 379.1481 379.1975 379.2410 379.2792 379.3131 379.3429 379.3690 379.3920
#&gt;  [65] 379.4122 379.4298 379.4451 379.4586 379.4705 379.4810 379.4903 379.4984
#&gt;  [73] 379.4869 379.4947 379.5017 379.5078 379.5132 379.5180 379.5222 379.5261
#&gt;  [81] 379.5295 379.5326 379.5354 379.5379 379.5402 379.5422 379.5440 379.5457
#&gt;  [89] 379.5471 379.5484 379.5496 379.5506 379.5515 379.5523 379.5530 379.5537
#&gt;  [97] 379.5542 379.5547 379.5551 379.5555
#&gt; </div><div class='input'>
<span class='co'># Logistic regression</span>
<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='no'>Birthwt</span>$<span class='no'>low</span>
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'>grpreg</span>(<span class='no'>X</span>, <span class='no'>y</span>, <span class='no'>group</span>, <span class='kw'>penalty</span><span class='kw'>=</span><span class='st'>"grLasso"</span>, <span class='kw'>family</span><span class='kw'>=</span><span class='st'>"binomial"</span>)
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>fit</span>)</div><div class='img'><img src='grpreg-6.png' alt='' width='480' height='480' /></div><div class='input'><span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'>grpreg</span>(<span class='no'>X</span>, <span class='no'>y</span>, <span class='no'>group</span>, <span class='kw'>penalty</span><span class='kw'>=</span><span class='st'>"grMCP"</span>, <span class='kw'>family</span><span class='kw'>=</span><span class='st'>"binomial"</span>)
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>fit</span>)</div><div class='img'><img src='grpreg-7.png' alt='' width='480' height='480' /></div><div class='input'><span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'>grpreg</span>(<span class='no'>X</span>, <span class='no'>y</span>, <span class='no'>group</span>, <span class='kw'>penalty</span><span class='kw'>=</span><span class='st'>"grSCAD"</span>, <span class='kw'>family</span><span class='kw'>=</span><span class='st'>"binomial"</span>)
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>fit</span>)</div><div class='img'><img src='grpreg-8.png' alt='' width='480' height='480' /></div><div class='input'><span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'>grpreg</span>(<span class='no'>X</span>, <span class='no'>y</span>, <span class='no'>group</span>, <span class='kw'>penalty</span><span class='kw'>=</span><span class='st'>"gel"</span>, <span class='kw'>family</span><span class='kw'>=</span><span class='st'>"binomial"</span>)
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>fit</span>)</div><div class='img'><img src='grpreg-9.png' alt='' width='480' height='480' /></div><div class='input'><span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'>grpreg</span>(<span class='no'>X</span>, <span class='no'>y</span>, <span class='no'>group</span>, <span class='kw'>penalty</span><span class='kw'>=</span><span class='st'>"cMCP"</span>, <span class='kw'>family</span><span class='kw'>=</span><span class='st'>"binomial"</span>)
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>fit</span>)</div><div class='img'><img src='grpreg-10.png' alt='' width='480' height='480' /></div><div class='input'><span class='fu'><a href='select-grpreg.html'>select</a></span>(<span class='no'>fit</span>, <span class='st'>"BIC"</span>)</div><div class='output co'>#&gt; $beta
#&gt; (Intercept)        age1        age2        age3        lwt1        lwt2 
#&gt;   -1.194072    0.000000    0.000000    0.000000   -6.940487    0.000000 
#&gt;        lwt3       white       black       smoke        ptl1       ptl2m 
#&gt;   -3.133163    0.000000    0.000000    0.000000    1.602972    0.000000 
#&gt;          ht          ui        ftv1        ftv2       ftv3m 
#&gt;    1.806523    0.000000    0.000000    0.000000    0.000000 
#&gt; 
#&gt; $lambda
#&gt; [1] 0.06423099
#&gt; 
#&gt; $df
#&gt; [1] 4.670807
#&gt; 
#&gt; $IC
#&gt;   [1] 234.6720 230.0990 230.0000 229.9536 229.9441 229.9598 229.9920 230.0346
#&gt;   [9] 229.2504 229.6901 229.9650 234.2584 234.6746 239.7532 239.9728 242.3188
#&gt;  [17] 242.7281 249.3212 255.2388 261.5262 261.6906 261.8543 265.4466 266.0958
#&gt;  [25] 266.5227 272.5203 272.7270 272.8737 272.9777 273.0514 273.1027 273.1361
#&gt;  [33] 273.1565 273.1643 273.1700 273.1707 273.1707 273.1707 273.1707 273.1707
#&gt;  [41] 273.1707 273.1707 273.1707 273.1707 273.1707 273.1707 273.1707 273.1707
#&gt;  [49] 273.1707 273.1707 273.1707 273.1707 273.1707 273.1707 273.1707 273.1707
#&gt;  [57] 273.1707 273.1707 273.1707 273.1707 273.1707 273.1707 273.1707 273.1707
#&gt;  [65] 273.1707 273.1707 273.1707 273.1707 273.1707 273.1707 273.1707 273.1707
#&gt;  [73] 273.1707 273.1707 273.1707 273.1707 273.1707 273.1707 273.1707 273.1707
#&gt;  [81] 273.1707 273.1707 273.1707 273.1707 273.1707 273.1707 273.1707 273.1707
#&gt;  [89] 273.1707 273.1707 273.1707 273.1707 273.1707 273.1707 273.1707 273.1707
#&gt;  [97] 273.1707 273.1707 273.1707 273.1707
#&gt; </div><div class='input'>
<span class='co'># Multitask learning (simulated example)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>1</span>)
<span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='fl'>50</span>
<span class='no'>p</span> <span class='kw'>&lt;-</span> <span class='fl'>10</span>
<span class='no'>k</span> <span class='kw'>&lt;-</span> <span class='fl'>5</span>
<span class='no'>X</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n</span>*<span class='no'>p</span>), <span class='no'>n</span>, <span class='no'>p</span>)
<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>n</span>*<span class='no'>k</span>, <span class='no'>X</span>[,<span class='fl'>1</span>] + <span class='no'>X</span>[,<span class='fl'>2</span>]), <span class='no'>n</span>, <span class='no'>k</span>)
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'>grpreg</span>(<span class='no'>X</span>, <span class='no'>y</span>)
<span class='co'># Note that group is set up automatically</span>
<span class='no'>fit</span>$<span class='no'>group</span></div><div class='output co'>#&gt; [1] 5  6  7  8  9  10
#&gt; Levels: 5 6 7 8 9 10</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>fit</span>)</div><div class='img'><img src='grpreg-11.png' alt='' width='480' height='480' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Patrick Breheny.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


